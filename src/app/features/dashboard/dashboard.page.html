<div class="min-h-screen bg-gray-950 p-6">
  <!-- KPI Cards Row -->
  <ng-container *ngIf="kpis$ | async as kpis">
    <app-kpi-cards
      [totalPortfolios]="kpis.totalPortfolios"
      [totalInvestment]="kpis.totalInvestment"
      [avgUnrealisedPnl]="kpis.avgUnrealisedPnl"
      [totalStocks]="kpis.totalStocks"
    />
  </ng-container>

  <!-- Middle Row: Portfolio Table + Movers -->
  <div class="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Portfolio Table (2/3 width) -->
    <div class="lg:col-span-2">
      <app-portfolio-table [portfolios]="(dashboardRows$ | async) ?? []" />
    </div>

    <!-- Top Gainers & Losers (1/3 width) -->
    <div class="space-y-6">
      <ng-container *ngIf="movers$ | async as movers">
        <app-movers-panel title="Top Gainers" icon="up" [rows]="movers.topGainers" />
        <app-movers-panel title="Top Losers" icon="down" [rows]="movers.topLosers" />
      </ng-container>
    </div>
  </div>

  <!-- Bottom Row: Sector Charts -->
  <div class="mt-6">
    <ng-container *ngIf="sectorExposure$ | async as exposure">
      <app-sector-charts [sectorExposure]="exposure" [pnlTrend]="(pnlTrend$ | async) ?? []" />
    </ng-container>
  </div>
</div>
